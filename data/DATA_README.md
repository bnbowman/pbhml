# PacBio Sample Data for Data Standards Hackathon #
# Author: Brett Bowman
# Date: September 18th, 2014

## Introduction ##
The primary method of analyzing multiplexed amplicon sequencing data generated
on a PacBio RS or RSII is using the **LongAmpliconAnalysis** protocol. When
run as part of a normal SMRT Analysis workflow, they generate an output folder
similar to those contained in the **jobs** directory.

Depending on whether the sample was multiplexed, and which options were
supplied during the design of the workflow, the out in these directories
will have slightly different contents and organizations.  Thus we have 
supplied a number of sample analysis jobs using the same input data but 
different analysis settings to represent the different ways in which HLA 
amplicon sequencing data could be processed by SMRT Analysis.

Ideally, a software tool should be able to take the output from such job 
folder and the results from typing the consensus sequences of that job 
and be able to generate **MIRING** and/or **HML** compliant reports.

## Sample Data ##
The sample data set used consists of a single SMRTcell run with 4 multiplexed
HLA amplicon samples, each sample contains a mixture of the 3 loci from
HLA Class I (HLA-A, B, and C), and each loci is heterozygous for a total
24 HLA alleles.

## Sample Analysis Runs ##
Single: This run contains sequences from only a single barcode, as if
        from an un-multiplexed sample.  This is the simplest dataset
        to work with, and we recommend starting here.

Split:  This run contains sequences from all four samples, separated
        by barcode.  This new mode is intended to be the default run 
        method for future multiplexed HLA runs.

Normal: This run contains sequences from all four samples combined
        into the same output files.

## Contents ##
jobs: Sample SMRT Analysis output directories for HLA sequencing.

typings: Text files describing the types of selected sequences from
               each sample output directory, separated by barcode pair.

SMRTbell_4x_barcodes.fasta: a FASTA file containing the barcode sequences
                            used to identify each.

## Selected Sample Output Files ##
data/amplicon_analysis.fastq: A file containing all of the consensus sequences
                generated by LongAmpliconAnalysis that passed all filters
                for PCR artifacts

data/amplicon_analysis_chimeras_noise.fastq: A file containing all consensus 
                generated, but suspected of being a PCR artifact.
                            
data/amplicon_analysis_fastq/ &
data/amplicon_analysis_chimeras_noise/:
                Folders containing the same sequences as the above files, only
                separated by barcode

input.xml:  XML file specifying the input data used for this job

settings.xml:  XML file specifying the settings for this job

log/P_AmpliconAnalysis/doBarcodeAmpliconAnalysis.log &
log/P_AmpliconAnalysis/doSplitBarcodeAmpliconAnalysis.log:
                Log files for the step that actually generates the consensus
                sequences, complete with the exact version and commandline
                used.

### Sample Typings ###
The contents of the columns in the *.typing files are as follows:

Sequence - Name of the consensus sequence being analyzed
gLen     - Length of the consensus sequence being analyzed
gType    - Most similar genomic sequence in the IMGT reference database
gPctId   - Percent identity between the consensus sequence and the above reference
gMis     - Number of mis-matches between sequence and reference.  Usually true novel variants
gIndel   - Number of indel differences between sequence and reference.  Usually sequencing error
cLen     - Length of the _in silico_ spliced, cDNA generated
cType    - Most similar nucleotide sequence in the IMGT reference database
cPctId   - Percent identity between the consensus sequence and the above reference
Type     - Final estimate of the HLA type.  gType if identical to genomic reference, otherwise cType.

All sequences were typed against v3.16.0 of the IMGT database

## Technical Notes ##
### Consensus Sequences ###
All consensus sequences are presented **raw**, or exactly as they were sequenced.
This means that all sequences should contain the full barcode and primer sequences
used to generate the amplicons.  In addition, they may be in either the 5-prime or
3-prime orientation.

### Spurious Sequences ###
Some of the output folders may contain additional sequences beyond the desired
6 alleles per sample, and any software tool for generating a MIRING report
from data generated with LongAmpliconAnalysis needs to be able to handle this.

This is because LongAmpliconAnalysis is designed to identify all novel alleles 
in the input data in a completely *de novo* manner, such that it doesn''t know 
whether a consensus sequence that it finds represents a truly desired allele 
or a PCR artifact.  There are filters build into LongAmpliconAnalysis that use
heuristics to separate true alleles from artifacts, but currently these features
are still in development.

For convenience, only consensus sequences corresponding to the true alleles
have typings in the typings directory.  So if a consensus sequence is
not listed in a file in that directory, it may be safely ignored.